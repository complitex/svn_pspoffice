# Отчеты и документы #

Jasper reports удобно использовать для вывода табличной информации с минимальными особенностями разметки и оформления отчета. Документы паспортного стола имеют уникальную разметку, вложенные таблицы и фиксированные размеры полей, множество различных значений, что делает оформление такого шаблона достаточно сложным в формате jasper. Структура такого шаблона становится очень сложной и непредсказуемой для генерации в разные текстовые форматы.

Решением было использовать в качестве шаблона формат Open Office. Одной из особенностей документов паспортного стола, это имитация заполнения бумажных форм. В качестве нижнего подчеркивания используются таблицы. На текущий момент формат RTF не везде поддерживает вложенные таблицы поэтому можно использовать подход каждая строка - новая таблица.

# Open Office #
В идеале можно было бы использовать в качестве шаблона один формат ODT  и далее автоматически конвертировать его в другие внутренними средствами Open Office при помощи библиотеке JODCinverter http://code.google.com/p/jodconverter/. Но для этого необходимо иметь установленный и настроенный сервер Open Office, что может требовать дополнительных затрат на администрирование. Поэтому на каждый формат используется свой шаблон, который экспортируется в ручную средствами редактора Open Office из основного шаблона ODT.

# RTF #
С форматом RTF можно работать как текстовым файлом. Имея шаблон RTF, можно найти в нем названия переменных и заменить их требуемым текстом значения. Для работы с шаблоном RTF используется класс RtfTemplate.

# PDF #
Для генерации PDF используется библиотека iText http://itextpdf.com/. Для создания шаблона PDF используются формы View -> Toolbars -> Form Controls. Пример тут http://blog.codecentric.de/en/2010/08/pdf-generation-with-itext/.

# ODT #
Для заполнения значений шаблона ODT используется библиотека ODFToolkit http://odftoolkit.org/.